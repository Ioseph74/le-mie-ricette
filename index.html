<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Recipes</title>
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#e85d26">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="My Recipes">
    <link rel="stylesheet" href="style.css?v=7">
    <link rel="stylesheet" href="auth.css?v=7">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="i18n.js"></script>
</head>
<body>

    <noscript>
        <div style="text-align:center;padding:60px 24px;font-family:sans-serif;">
            <h2>JavaScript Required</h2>
            <p>This application requires JavaScript to function. Please enable it in your browser settings.</p>
        </div>
    </noscript>

    <header class="header">
        <div class="header-content">
            <h1 class="logo"><i class="fas fa-utensils"></i> <span id="appTitle">My Recipes</span></h1>
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search recipe or ingredient..." aria-label="Search recipe or ingredient">
                <button class="advanced-search-toggle" id="btnAdvancedSearch" onclick="toggleAdvancedSearch()" title="Advanced Search">
                    <i class="fas fa-filter"></i>
                </button>
            </div>
            <button class="btn-new auth-only" onclick="window.location.href='editor.html'" aria-label="New Recipe" id="btnNewRecipe">
                <i class="fas fa-plus"></i> <span>New Recipe</span>
            </button>

            <div id="langSelectorContainer"></div>

            <!-- AUTH -->
            <div class="user-info" id="userInfo" style="display:none;">
                <img class="user-avatar" id="userAvatar" src="" alt="User avatar">
                <span class="user-name" id="userName"></span>
            </div>
            <button class="btn-login" id="loginBtn" onclick="login()" style="display:none;" aria-label="Sign in with Google">
                <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google">
                <span id="loginText">Sign in</span>
            </button>
            <button class="btn-logout" id="logoutBtn" onclick="logout()" style="display:none;" title="Sign out" aria-label="Sign out">
                <i class="fas fa-sign-out-alt"></i>
            </button>
        </div>
    </header>

    <section class="filters">
        <div class="filters-content" id="filtersContent">
            <button class="filter-btn active" data-category="tutte">All</button>
            <button class="filter-btn" data-category="antipasti">ğŸ¥— Appetizers</button>
            <button class="filter-btn" data-category="primi">ğŸ First Courses</button>
            <button class="filter-btn" data-category="secondi">ğŸ¥© Main Courses</button>
            <button class="filter-btn" data-category="contorni">ğŸ¥¦ Side Dishes</button>
            <button class="filter-btn" data-category="dolci">ğŸ° Desserts</button>
            <button class="filter-btn" data-category="pane-e-lievitati">ğŸ Bread & Baked</button>
            <button class="filter-btn" data-category="salse-e-condimenti">ğŸ«™ Sauces</button>
            <button class="filter-btn" data-category="bevande">ğŸ¥¤ Beverages</button>
            <button class="filter-btn" data-category="conserve">ğŸº Preserves</button>
            <button class="filter-btn" data-category="base">ğŸ“‹ Basics</button>
        </div>
    </section>

    <div id="userFilterContainer"></div>

    <div class="advanced-search-panel" id="advancedSearchPanel">
        <div class="advanced-search-inner">
            <h4><i class="fas fa-filter"></i> <span id="advSearchTitle">Filter by Tags</span></h4>
            <div id="advSearchTags"></div>
            <div class="advanced-search-actions">
                <button class="btn-secondary" onclick="clearTagFilters()" id="btnClearFilters"><i class="fas fa-times"></i> Clear</button>
            </div>
        </div>
    </div>

    <main class="recipes-grid" id="recipesGrid"></main>

    <div class="empty-state" id="emptyState" style="display: none;">
        <i class="fas fa-book-open"></i>
        <h2 id="emptyTitle">No recipes found</h2>
        <p id="emptyMessage">Start by adding your first recipe!</p>
        <button class="btn-new auth-only" onclick="window.location.href='editor.html'" id="btnCreateRecipe">
            <i class="fas fa-plus"></i> <span>Create Recipe</span>
        </button>
    </div>

    <div class="shopping-overlay" id="shoppingOverlay"></div>
    <aside class="shopping-panel" id="shoppingPanel">
        <div class="shopping-header">
            <h2><i class="fas fa-shopping-cart"></i> <span id="shopTitle">Shopping List</span></h2>
            <button class="btn-close" onclick="toggleShopping()" aria-label="Close shopping list"><i class="fas fa-times"></i></button>
        </div>
        <div class="shopping-list" id="shoppingList">
            <p class="shopping-empty" id="shopEmpty">The list is empty</p>
        </div>
        <div class="shopping-actions">
            <button class="btn-secondary" onclick="clearShopping()" id="btnShopClear">
                <i class="fas fa-trash"></i> <span>Clear</span>
            </button>
            <button class="btn-primary" onclick="printShopping()" id="btnShopPrint">
                <i class="fas fa-print"></i> <span>Print</span>
            </button>
        </div>
    </aside>

    <button class="fab-shopping" id="fabShopping" onclick="toggleShopping()" aria-label="Open shopping list">
        <i class="fas fa-shopping-cart"></i>
        <span class="fab-badge" id="fabBadge" style="display:none;">0</span>
    </button>

    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="utils.js"></script>
    <script src="shopping-list.js"></script>
    <script src="app.js"></script>

</body>
</html>